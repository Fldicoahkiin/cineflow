# CineFlow 开发 TODO（不含付费功能）

## 当前阶段：UI重构和功能完善 ✅ 已完成

### 已完成 ✅
- [x] 项目初始化和基础结构
- [x] 播放器集成（media_kit）
- [x] 文件选择功能（file_picker）
- [x] 本地环回测试系统
- [x] WebSocket 信令客户端
- [x] 消息协议定义
- [x] RTT 测量和时间轴补偿算法
- [x] 基础 UI 框架
- [x] 状态管理服务
- [x] 文件管理服务
- [x] 应用管理器
- [x] 错误处理和重连机制

#### 最新完成（2025-08-16）
- [x] **P2P 连接建立**
  - [x] WebRTC PeerConnection 完整实现
  - [x] ICE 候选交换
  - [x] SDP 协商流程
  - [x] 数据通道建立

- [x] **会话管理**
  - [x] 创建会话功能
  - [x] 加入会话功能
  - [x] 会话状态管理
  - [x] 连接状态监控

- [x] **UI/UX 重构**
  - [x] Material Design 3.0 完全合规
  - [x] 现代化按钮和组件系统
  - [x] 播放器界面改进
  - [x] 连接状态指示器
  - [x] 用户反馈优化
  - [x] 卡片式布局设计
  - [x] 主题色彩系统集成

- [x] **代码质量优化**
  - [x] 编译错误修复
  - [x] API兼容性调整
  - [x] 代码结构清理
  - [x] 无用文件清理

### 待开发 

#### 核心功能增强
- [ ] **同步播放**
  - [ ] 播放/暂停同步
  - [ ] 进度条同步
  - [ ] 音量同步
  - [ ] 播放速率同步

- [ ] **会话管理增强**
  - [ ] 参与者列表维护
  - [ ] 会话权限管理
  - [ ] 会话重连机制

#### 用户界面增强
- [ ] **文件管理**
  - [ ] 本地文件浏览
  - [ ] 文件格式验证
  - [ ] 播放历史记录

#### 技术优化
- [ ] **性能优化**
  - [ ] 内存使用优化
  - [ ] 网络带宽优化
  - [ ] 电池使用优化

### 技术债务 
- [ ] 单元测试添加
- [ ] 集成测试完善
- [ ] 代码注释补充

### 已知问题 
- [ ] 播放器在某些设备上的兼容性问题
- [ ] WebSocket 连接在网络切换时的稳定性
- [ ] 大文件加载时的内存占用

## 后续拓展

### 高级功能
- [ ] 会话密码
- [ ] 多人讨论
- [ ] 视频预下载（主持人设置下载链接或用户配置中转服务器）
- [ ] 字幕同步
- [ ] 倍速播放
- [ ] 更多播放格式和协议支持

### 平台扩展
- [ ] Windows 版本优化
- [ ] 桌面版本优化
- [ ] RTT/时间轴补偿（高级版：自适应抖动与窗口滤波）
- [ ] 多端联调（macOS → Android → iOS → Linux → Windows）
- [ ] 文档完善与问题清单追踪

---

## 开发注意事项

1. **优先级**：核心 P2P 功能 > UI 优化 > 性能优化
2. **测试**：每个功能完成后进行充分测试
3. **文档**：及时更新 API 文档和用户文档
4. **兼容性**：确保跨平台兼容性（iOS、Android、Windows、macOS、Linux）
